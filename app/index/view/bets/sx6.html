<!DOCTYPE html>
<html>
<head>
    <title>合肖</title>
    <meta charset="utf-8">
    <script src="__IMAGES__/jquery.min.js"></script>
    <link rel="stylesheet" href="__LAYUI__/css/layui.css">
    <script src="__LAYUI__/layui.js"></script>
    <style>
        .layui-table th{
            text-align: center;
        }
        .layui-table td{
            font-size: 16px;
        }
        input[type='checkbox']{
            background-color: #fff;
            -webkit-appearance:none;
            border: 1px solid #c9c9c9;
            border-radius: 2px;
            outline: none;
            width: 30px;
            height: 30px;
        }
        .checkBox input[type=checkbox]:checked{
            background: url("__IMAGES__/checked.png")no-repeat center;
        }
        /*.b{*/
            /*background-color: rgb(236,110,26);*/
            /*padding: 5px;*/
        /*}*/
    </style>
</head>
<body>
<body>
<div class="layui-fluid">
    <div class="layui-row"  style="background-color: #fff;">
        <div class="layui-col-xs12">
            <form action="{:url('sxSubmit')}" id="form" method="post">
                <input type="hidden" name="class2" value="{$ids}">
                <div class="layui-crad">
                    {include file="public/top"/}
                    <div class="layui-card-header">

                        {$ids}
                        <span style="padding-left: 40px;">封盘倒计时：<b class="time" style="color: red;font-weight: normal;"></b></span>
                        <div class="layui-inline" style="margin-left: 10px;">下注金额:<span id="allgold">0</span></div>

                        <div style="float: right;" class="layui-btn-group">
                            <a href="{:url('')}?ids=二肖" class="layui-btn layui-btn-sm speed">二肖</a>
                            <a href="{:url('')}?ids=三肖" class="layui-btn layui-btn-sm speed">三肖</a>
                            <a href="{:url('')}?ids=四肖" class="layui-btn layui-btn-sm speed">四肖</a>
                            <a href="{:url('')}?ids=五肖" class="layui-btn layui-btn-sm speed">五肖</a>
                            <a href="{:url('')}?ids=六肖" class="layui-btn layui-btn-sm speed">六肖</a>
                            <a href="{:url('')}?ids=七肖" class="layui-btn layui-btn-sm speed">七肖</a>
                            <a href="{:url('')}?ids=八肖" class="layui-btn layui-btn-sm speed">八肖</a>
                            <a href="{:url('')}?ids=九肖" class="layui-btn layui-btn-sm speed">九肖</a>
                            <a href="{:url('')}?ids=十肖" class="layui-btn layui-btn-sm speed">十肖</a>
                            <a href="{:url('')}?ids=十一肖" class="layui-btn layui-btn-sm speed">十一肖</a>
                        </div>
                    </div>
                    <div class="layui-card-body">
                        <table class="layui-table">
                            <colgroup>
                                <col width="60">
                                <col width="75">
                                <col width="60">
                                <col width="30%">
                                <col width="60">
                                <col width="75">
                                <col width="60">
                                <col>
                            </colgroup>
                            <thead>
                            <tr>
                                <th colspan="8">{$ids}</th>
                            </tr>
                            </thead>
                            <tbody>
                            {for start="0" end="6"}
                            <tr>
                                <td class="td{$i}">{$data[$i]['class3']}</td>
                                <td class="td{$i}"><span id="pfix{$i}" style="color:red;font-weight: bold;">{$data[$i]['rate']}</span></td>
                                <td class="td{$i}">
                                    <label class="checkBox"><input type="checkbox" name="num{$i}" id="num{$i}" class="c1" value="{$data[$i]['class3']}"></label>
                                </td>
                                <td class="td{$i}">
                                    {foreach name="data[$i]['class3_number']" id="cnum"}
                                    {if condition="$cnum neq 49"}
                                    <img src="__IMAGES__/num{$cnum}.gif" />
                                    {/if}
                                    {/foreach}
                                </td>

                                <td class="td{$i+6}">{$data[$i+6]['class3']}</td>
                                <td class="td{$i+6}"><span id="pfix{$i+6}" style="color:red;font-weight: bold;">{$data[$i+6]['rate']}</span></td>
                                <td class="td{$i+6}">
                                    <label class="checkBox"><input type="checkbox" name="num{$i+6}" id="num{$i+6}" class="c1" value="{$data[$i+6]['class3']}"></label>
                                </td>
                                <td class="td{$i+6}">
                                    {foreach name="data[$i+6]['class3_number']" id="c1"}
                                    {if condition="$c1 neq 49"}
                                    <img src="__IMAGES__/num{$c1}.gif" />
                                    {/if}
                                    {/foreach}
                                </td>
                            </tr>
                            {/for}
                            <tr>
                                <td colspan="8">
                                    快速下注：{if condition="$ids eq '六肖'"}
                                    <a href="javascript:;" class="b b1 layui-btn layui-btn-xs layui-btn-primary">前肖</a>
                                    <a href="javascript:;" class="b b2 layui-btn layui-btn-xs layui-btn-primary">后肖</a>
                                    <a href="javascript:;" class="b b3 layui-btn layui-btn-xs layui-btn-primary">家禽</a>
                                    <a href="javascript:;" class="b b4 layui-btn layui-btn-xs layui-btn-primary">野獸</a>
                                    {/if}
                                    <a href="javascript:;" class="b b0 layui-btn layui-btn-xs layui-btn-primary">反选</a>

                                </td>
                            </tr>
                            <tr>
                                <td colspan="8" align="center">
                                    <input type="hidden" name="xc" value="{$xc}">
                                    <input type="hidden" name="r_init" id="r_init" value="100">
                                    <input name="min_bl" id="min_bl" type="hidden" value="" />
                                    <input type="hidden" name="from_url" value="{:url('')}?ids={$ids}">

                                    赔率：<span id="bl0" style="color:red;font-weight: bold;">0</span>

                                    <div class="layui-inline" style=" margin: 0 5px;">
                                        <label class="">下注金额:</label>
                                        <div class="layui-input-inline" style="width: 100px;">
                                            <input type="text" name="Num_1" class="input1 layui-input" placeholder="￥">
                                        </div>
                                    </div>

                                    <input type="submit" class="layui-btn layui-btn-sm" value="提交">
                                    <input type="reset" class="layui-btn layui-btn-sm layui-btn-primary" value="重设">
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
$(function () {
    {if condition="$ids eq '六肖'"}
        var type_num=6;
    {elseif condition="$ids eq '七肖'"}
        var type_num=7;
    {elseif condition="$ids eq '八肖'"}
        var type_num=8;
    {elseif condition="$ids eq '九肖'"}
        var type_num=9;
    {elseif condition="$ids eq '十肖'"}
        var type_num=10;
    {elseif condition="$ids eq '十一肖'"}
        var type_num=11;
    {elseif condition="$ids eq '五肖'"}
        var type_num=5;
    {elseif condition="$ids eq '四肖'"}
        var type_num=4;
    {elseif condition="$ids eq '三肖'"}
        var type_num=3;
    {elseif condition="$ids eq '二肖'"}
        var type_num=2;
    {/if}

     layui.use(['layer'],function () {
         var layer=layui.layer;
         $('[name=Num_1]').blur(function(){
             var re = /^[0-9]+\.?[0-9]*$/;
             var value = $(this).val();
             if(!re.test(value) && value!=''){
                 layer.msg('下注金额仅能输入数字',{icon:2});
                 $(this).val('0');
             }
             if($(this).val()==''){
                 value=0;
             }
             if ( (value < {:getMemField('xy')}) && (value!='')) {$(this).val('0');$(this).focus();  layer.msg("下注金额不可小於最低限度:{:getMemField('xy')}!!",{icon:2}); return false;}
             if (value > {:getQuotaField($xc,'xx')}) {$(this).val('0');$(this).focus(); layer.msg("对不起,下注金额已超过单注限额 : {:getQuotaField($xc,'xx')}!!",{icon:2}); return false;}
             if (value > {:getMemField('ts')})   {$(this).val('0');$(this).focus();  layer.msg("下注金额不可大於可用信用额度!!",{icon:2});    return false;}
         });

         //表格
         $('.layui-table td').hover(function () {
             var className=$(this).attr('class');
             $('.'+className).css({'background-color':'#f2f2f2'});
         },function () {
             var className=$(this).attr('class');
             $('.'+className).removeAttr('style');
         });

         $('form').submit(function () {
             var re = /^[0-9]+\.?[0-9]*$/;
             var value=$('[name=Num_1]').val();
             if($.trim(value)==''){
                 layer.msg('请输入下注金额！',{icon:2});
                 return false;
             }
             if(!re.test(value) && value!=''){
                 layer.msg('下注金额仅能输入数字！',{icon:2});
                 return false;
             }
             if(parseFloat(value) > {:getMemField('ts')}){
                 layer.msg('下注金额不可大於可用信用额度!!',{icon:2});
                 return false;
             }
             if(parseFloat(value)<{:getMemField('xy')}){
                 layer.msg('下注金额不能小于{:getMemField('xy')}！',{icon:2});
                 return false;
             }
             if (parseFloat(value) > {:getQuotaField($xc,'xx')}) {
                 layer.msg('对不起,下注金额已超过单注限额 : {:getQuotaField($xc,'xx')}!!',{icon:2});
                 return false;
             }


             var size=$('[type=checkbox]:checked').size();
            if(size!=type_num){
                layer.msg('请选择'+type_num+'个生肖',{icon:2});
                return false;
            }
             // $('#btnSubmit').attr('disabled','disabled');

             layer.open({
                 type: 2,
                 title: '确认注单',
                 shadeClose: false,
                 shade: 0.3,
                 maxmin: true,
                 area: ['700px', '500px'],
                 content: '{:url("sxSubmit")}?'+$('form').serialize()
             });
             return false;
         });
     })

    function getBl(){
        var sz=[];
        for (var i=0;i<12;i++){
            if($('[name=num'+i+']').prop('checked')){
                sz.push($('#pfix'+i).html());
            }
        }
        if(sz.length>=1){
            sz=sz.sort();
            $('#bl0').html(sz[0]);
            $('[name=min_bl]').val(sz[0]);
        }
    }

    $('[type=checkbox]').click(function () {
        console.log('cccc');
        getBl();
    })

    //前肖
    $('.b1').click(function () {
        for (var j=0;j<12;j++){
            if(j==0 || j==1 || j==2 || j==6 || j==7 || j==8){
                $('[name=num'+j+']').prop('checked',true);
            }else{
                //$('[name=num'+j+']').removeAttr('checked');
                $('[name=num'+j+']').prop('checked',false);
            }
        }
        getBl();
    })

    //后肖
    $('.b2').click(function () {
        for (var j=0;j<12;j++){
            if(j==3 || j==4 || j==5 || j==9 || j==10 || j==11){
                $('[name=num'+j+']').prop('checked',true);
            }else{
                $('[name=num'+j+']').prop('checked',false);
            }
        }
        getBl();
    })

    //家禽
    $('.b3').click(function () {
        for (var j=0;j<12;j++){
            if(j==3 || j==5 || j==6 || j==9 || j==10 || j==11){
                $('[name=num'+j+']').prop('checked',true);
            }else{
                $('[name=num'+j+']').prop('checked',false);
            }
        }
        getBl();
    })

    //野兽
    $('.b4').click(function () {
        for (var j=0;j<12;j++){
            if(j==0 || j==1 || j==2 || j==3 || j==7 || j==8){
                $('[name=num'+j+']').prop('checked',true);
            }else{
                $('[name=num'+j+']').prop('checked',false);
            }
        }
        getBl();
    })

    //反选
    $('.b0').click(function () {
        for (var j=0;j<12;j++){
            if($('[name=num'+j+']').prop('checked')){
                $('[name=num'+j+']').prop('checked',false);
            }else{
                $('[name=num'+j+']').prop('checked',true);
            }
        }
        getBl();
    })
    //计算倒计时
    var time=parseInt({:strtotime(getKithe(14))-time()});
    countDown(time);
    //带天数的倒计时
    function countDown(times){
        var timer=null;
        timer=setInterval(function(){
            var day=0,
                hour=0,
                minute=0,
                second=0;//时间默认值
            if(times > 0){
                day = Math.floor(times / (60 * 60 * 24));
                hour = Math.floor(times / (60 * 60)) - (day * 24);
                minute = Math.floor(times / 60) - (day * 24 * 60) - (hour * 60);
                second = Math.floor(times) - (day * 24 * 60 * 60) - (hour * 60 * 60) - (minute * 60);
            }
            if (day <= 9) day = '0' + day;
            if (hour <= 9) hour = '0' + hour;
            if (minute <= 9) minute = '0' + minute;
            if (second <= 9) second = '0' + second;
            //console.log();
            $('.time').html(day+"天"+hour+"小时"+minute+"分钟&nbsp;&nbsp;"+second+"秒");
            times--;
        },1000);
        if(times<=0){
            clearInterval(timer);
        }
    }
})
</script>


</body>
</html>